<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CmdLine.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc1 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>CmdLine.cpp</h1><a href="CmdLine_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* Copyright (C) Kwee Heong Tan 2002 - 2003</span>
00002 <span class="comment">   Permission is granted to use this code without restriction as</span>
00003 <span class="comment">   long as this copyright notice appears in all source files.</span>
00004 <span class="comment">*/</span>
00005 <span class="comment">// $Id: CmdLine.cpp,v 1.16 2002/11/28 18:24:45 khtan Exp khtan $</span>
00006 <span class="preprocessor">#include "<a class="code" href="CmdLine_8h.html">CmdLine.h</a>"</span> <span class="comment">// include this first so that pragma warning will take effect</span>
00007 <span class="preprocessor">#ifndef STL96 // preprocessor token for very old STL, circa 1996 that does not have namespace functionality</span>
00008 <span class="preprocessor"></span>   <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00009 <span class="preprocessor">#endif</span>
<a name="l00010"></a><a class="code" href="classCmdLine.html#a0">00010</a> <span class="preprocessor"></span>
00011 <a class="code" href="classCmdLine.html#a0">CmdLine::CmdLine</a>(){
00012   debug=<span class="keyword">false</span>;
00013 }
00014 <span class="keywordtype">void</span> <a class="code" href="classCmdLine.html#a1">CmdLine::addParameterSwitch</a>(<span class="keyword">const</span> string flag,<span class="keyword">const</span> string initialValue,<span class="keyword">const</span> string help){
00015   m.insert(mapType::value_type(flag,initialValue));
00016   h.insert(mapType::value_type(flag,help));
00017 }
00018 <span class="keywordtype">void</span> <a class="code" href="classCmdLine.html#a2">CmdLine::addStandaloneSwitch</a>(<span class="keyword">const</span> string flag,<span class="keyword">const</span> string help){
00019   <a class="code" href="classCmdLine.html#a1">addParameterSwitch</a>(flag,<span class="stringliteral">"unset"</span>,help);
00020 }
00021 <span class="keyword">const</span> string&amp; <a class="code" href="classCmdLine.html#a3">CmdLine::switchValue</a>(<span class="keyword">const</span> string flag){
00022   <span class="keywordflow">return</span> m[flag];
00023 }
00024 <span class="keyword">const</span> string&amp; <a class="code" href="classCmdLine.html#a4">CmdLine::switchHelp</a>(<span class="keyword">const</span> string flag){
00025   <span class="keywordflow">return</span> h[flag];
<a name="l00026"></a><a class="code" href="classCmdLine.html#a5">00026</a> }
00027 <span class="keywordtype">void</span> <a class="code" href="classCmdLine.html#a5">CmdLine::process</a>(<span class="keywordtype">int</span> argc,<span class="keywordtype">char</span>** argv){
00028         <span class="keywordflow">if</span>(debug==<span class="keyword">true</span>) cout &lt;&lt; <span class="stringliteral">"Processing input arguments\n"</span>;
00029         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;argc;i++){ <span class="comment">// C++ skip command name itself, in argv[0]</span>
00030             <span class="keywordflow">if</span>(debug==<span class="keyword">true</span>){
00031               cout &lt;&lt; <span class="stringliteral">"\targv["</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">"] "</span> &lt;&lt; argv[i] &lt;&lt; <span class="stringliteral">"\n"</span>;
00032             }
00033             string flag=argv[i];
00034             mapType::iterator pos=m.find(flag);
00035             
00036             <span class="keywordflow">if</span>(pos==m.end()){
00037               l.push_back(argv[i]);
00038             }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="stringliteral">"unset"</span>==(*pos).second){
00039               m.erase(pos);
00040               m.insert(mapType::value_type(flag,<span class="stringliteral">"set"</span>));
00041             }<span class="keywordflow">else</span>{
00042               m.erase(pos);
00043               m.insert(mapType::value_type(flag,argv[++i]));
00044             }
00045         }
<a name="l00046"></a><a class="code" href="classCmdLine.html#a6">00046</a> }
00047 <span class="keywordtype">int</span> <a class="code" href="classCmdLine.html#a6">CmdLine::NumberOfRemainingParameters</a>(){
00048   <span class="keywordflow">return</span> l.size();
<a name="l00049"></a><a class="code" href="classCmdLine.html#a7">00049</a> }
00050 <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classCmdLine.html#a7">CmdLine::RemainingParameter</a>(<span class="keywordtype">int</span> index){
00051   <span class="keywordflow">return</span> l[index];
00052   <span class="comment">// return l.at(index);</span>
00053 }
00054 <span class="keywordtype">void</span> <a class="code" href="classCmdLine.html#a8">CmdLine::printSwitches</a>(ostream&amp; s){
00055   mapType::const_iterator mI;
00056   s.setf(ios::left);
00057   <span class="keywordflow">for</span>( mI=m.begin();mI!=m.end();++mI){
00058     s &lt;&lt; <span class="stringliteral">"\t"</span>;
00059     s.width(10);
00060 <span class="preprocessor">    #ifdef STL96</span>
00061 <span class="preprocessor"></span>        s &lt;&lt; (*mI).first;
00062         s.width(20);
00063         s &lt;&lt; <a class="code" href="classCmdLine.html#a4">switchHelp</a>((*mI).first) &lt;&lt; <span class="stringliteral">"\n"</span>;
00064 <span class="preprocessor">    #else</span>
00065 <span class="preprocessor"></span>        s &lt;&lt; mI-&gt;first;
00066         s.width(20);
00067         s &lt;&lt; <a class="code" href="classCmdLine.html#a4">switchHelp</a>(mI-&gt;first) &lt;&lt; <span class="stringliteral">"\n"</span>;
00068 <span class="preprocessor">    #endif</span>
00069 <span class="preprocessor"></span>  }
00070   s.unsetf(ios::left);
00071 }
00072 <span class="keywordtype">void</span> <a class="code" href="classCmdLine.html#a9">CmdLine::dump</a>(ostream&amp; s)<span class="keyword"> const</span>{
00073     const_cast&lt;CmdLine *&gt;(this)-&gt;dump(s);
00074 }
00075 <span class="keywordtype">void</span> <a class="code" href="classCmdLine.html#a9">CmdLine::dump</a>(ostream&amp; s){
00076   s &lt;&lt; <span class="stringliteral">"State of switches\n"</span>;
00077   mapType::const_iterator mI;
00078   s.setf(ios::left);
00079   <span class="keywordflow">for</span>( mI=m.begin();mI!=m.end();++mI){
00080     s &lt;&lt; <span class="stringliteral">"\t"</span>;
00081     s.width(10);
00082 <span class="preprocessor">    #ifdef STL96</span>
00083 <span class="preprocessor"></span>       s &lt;&lt; (*mI).first;
00084        s.width(20);
00085        s &lt;&lt; (*mI).second &lt;&lt; <span class="stringliteral">"\t:"</span>&lt;&lt; <a class="code" href="classCmdLine.html#a4">switchHelp</a>((*mI).first) &lt;&lt; <span class="stringliteral">"\n"</span>;
00086 <span class="preprocessor">    #else</span>
00087 <span class="preprocessor"></span>       s &lt;&lt; mI-&gt;first;
00088        s.width(20);
00089        s &lt;&lt; mI-&gt;second &lt;&lt; <span class="stringliteral">"\t:"</span>&lt;&lt; <a class="code" href="classCmdLine.html#a4">switchHelp</a>(mI-&gt;first) &lt;&lt; <span class="stringliteral">"\n"</span>;
00090 <span class="preprocessor">    #endif</span>
00091 <span class="preprocessor"></span>  }
00092   s.unsetf(ios::left);
00093   s &lt;&lt; <span class="stringliteral">"Remaining parameters\n"</span>;
00094   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classCmdLine.html#a6">NumberOfRemainingParameters</a>();++i){
00095     s &lt;&lt; <span class="stringliteral">"\t"</span> &lt;&lt; <a class="code" href="classCmdLine.html#a7">RemainingParameter</a>(i) &lt;&lt; <span class="stringliteral">"\n"</span>;
00096   }
00097 }
<a name="l00098"></a><a class="code" href="CmdLine_8cpp.html#a0">00098</a> 
00099 ostream&amp; <a class="code" href="DLogic_8cpp.html#a0">operator&lt;&lt;</a>(ostream &amp;s,<span class="keyword">const</span> <a class="code" href="classCmdLine.html">CmdLine</a>&amp; c){
00100   c.<a class="code" href="classCmdLine.html#a9">dump</a>(s);
00101   <span class="keywordflow">return</span> s;
00102 }
</pre></div><hr><address style="align: right;"><small>Generated on Mon Jan 20 11:54:25 2003 for ATPG by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc1 </small></address>
</body>
</html>
